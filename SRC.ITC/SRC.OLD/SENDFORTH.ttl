; macro to send Forth source code to a board with no interrupts on comm port
; Method
; 1. wait for each echoed character
; 2. on CR wait for 'OK' from the board

   source_file_name = "lib.itc\ansfiles.fth"
   filesearch source_file_name
   if result = 0 then
        messagebox 'Cannot open file' 'ERROR'
        end
   endif

  timeout = 2

  fileopen fh source_file_name 0
  filereadln fh line

  ; setdebug 1           ; need debug mode to see control chars.
                       ; With debug = 1 XON will n ^Q
  flushrecv
  while result = 0

       send line  #13
  ;    wait 'ok'
  ;     if result = 0 then
  ;        messagebox 'Did not get [ok]'
  ;     endif

       filereadln fh line
  endwhile
  fileclose fh

 ; setdebug 0 ; debug off
