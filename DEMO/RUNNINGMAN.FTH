\ RUNNINGMAN animation 
\ graphics by @oddeman, ATARTIAGE.COM 
\ code: @theBF

INCLUDE DSK1.TOOLS
INCLUDE DSK1.GRAFIX
INCLUDE DSK1.VTYPE
INCLUDE DSK1.CHARSET
INCLUDE DSK1.MARKER

MARKER REMOVE

DECIMAL
: PATTERN! ( data[512] -- ) 33 ]PDT 512 VWRITE  ;

: HEX#, ( addr len  --) \ can be used for longstrings (80 bytes)
        BASE @ >R  \ save radix
        HEX               \ we are converting hex numbers in the string
        BEGIN
        DUP WHILE        \ while len<>0
            2DUP DROP 4  \ get 4 digits from left end of string
            NUMBER? ABORT" Bad number"  \ convert string to number
             ,           \ compile the integer into memory
            4 /STRING    \ cut 4 digits off left side of string
        REPEAT
        2DROP
        R> BASE !  \ restore radix
;

\ Display initial graphic
DECIMAL
: .FIGURE ( col -- )
    DUP  3 AT-XY  33 (EMIT) 34 (EMIT) S" #$%&'(" VTYPE
    DUP  4 AT" )*+,-./0"
    DUP  5 AT" 12345678"
    DUP  6 AT" 9:;<=>?@"
    DUP  7 AT" ABCDEFGH"
    DUP  8 AT" IJKLMNOP"
    DUP  9 AT" QRSTUVWX"
        10 AT" YZ[\]^_`"
;
: BLANKLN  ( col row -- ) >VPOS 8 BL VFILL ;

: /FIGURE ( n -- ) \ erase screen where frame is displayed
    DUP  3 BLANKLN
    DUP  4 BLANKLN
    DUP  5 BLANKLN
    DUP  6 BLANKLN
    DUP  7 BLANKLN
    DUP  8 BLANKLN
    DUP  9 BLANKLN
        10 BLANKLN
;


CREATE FRAME0
S" 0000000000000000000000000000000000000000000000000000000102040000" HEX#,
S" 0000000000002010000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000500510810001120410051" HEX#,
S" 0010204000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000082547804021108058111811180158A11" HEX#,
S" 0000000520450850004000008040000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000002010200020100010F04000408040A01" HEX#,
S" 8000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000003855000000000000005500010001000002010810081402110010" HEX#,
S" 0040001004442211000000000000000000000000000000000000000000000000" HEX#,
S" 48400B50005030500000A01500000000220501410B00000020502050C0000000" HEX#,
S" 1811011109110901000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0805000500050B01000000008000805400000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0805000000000000085000000000000000000000000000000000000000000000" HEX#,


CREATE FRAME1
S" 0000000000000000000000000000000000000000000000000000000102040004" HEX#,
S" 0000001008000800000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000010810101100418041" HEX#,
S" 0810004000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000002050105030503018801911180502A55" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000010200020402012014020008141211" HEX#,
S" 8054225400000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000010201000030500C15105400010101004130051010001088048245" HEX#,
S" 0000004020101010000000000000000000000000000000000000000000000000" HEX#,
S" 000002010000000082000000000000008050220100000000C854205408000000" HEX#,
S" A844785040444040000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 4044404408442857000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 2055000000000000E05000000000000000000000000000000000000000000000" HEX#,


CREATE FRAME2
S" 0000000000000000000000000000000000000000000000000000000102040000" HEX#,
S" 0000001000100010000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000102000810205180010211" HEX#,
S" 0010204000000000000000000000000000000000000000000000000000000000" HEX#,
S" 00000000000000000000000000000000000408151A1509052041810100000205" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 00000000000000000000000000000000040402050405000182450A5199512804" HEX#,
S" 0000804000400000000000000000000000000000000000000000000000000000" HEX#,
S" 00000000000000000000000100040205020100018054030106058341E0503815" HEX#,
S" 0000000080402050000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000020402070201000020558000800000000301201523152244" HEX#,
S" 9050B05000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000001000100014C44085090102050" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000002010000000000000C55000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,


CREATE FRAME3
S" 0000000000000000000000000000000000000000000000000000000400000010" HEX#,
S" 0000004000002010000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000011420510010205180012041" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 00000000000000000000000000000000FE540851291512158001800102010205" HEX#,
S" 0000000000412A01000000000040004000000000000000000000000000000000" HEX#,
S" 000000000000000000000000000000000A150E0500040201000408100C050000" HEX#,
S" AA01000000008050800000000000000000000000000000000000000000000000" HEX#,
S" 00000000000000000000000000000000000101010001010120140E0108050B15" HEX#,
S" 080503512B450214000000008000000000000000000000000000000000000000" HEX#,
S" 000000000000000000000000000000000001000101050604B840021400100050" HEX#,
S" 2040000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000001030108102145CC1830144854000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 000000000000000001010000000000000E550000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,


CREATE FRAME4
S" 0000000000000000000000000000000000000000000000000000021000100010" HEX#,
S" 0000004000400000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000010000000000003B10B05510510010A20100518101" HEX#,
S" 004000141A142840000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000500051085408558001800181010204" HEX#,
S" 88509050A0400000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000001010201020502050004000406050041" HEX#,
S" 0000000000008040000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000004040810001021412054224100000000" HEX#,
S" 201008048A553215000000000000000000000000000000000000000000000000" HEX#,
S" 000000000A150215000102508005200060440850200000000000000000000000" HEX#,
S" 0801080008040004000000008000804000000000000000000000000000000000" HEX#,
S" 2040001008100000000000000000000000000000000000000000000000000000" HEX#,
S" 0200000102010000004020510A54000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,


CREATE FRAME5
S" 0000000000000000000000000000000000000000000000000000021000100010" HEX#,
S" 0000004000402000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000021428450000225102012041" HEX#,
S" 0040800000000000000000000000000000000000000000000000000000000000" HEX#,
S" 000000000000000000000000000000002C442005001402118001800180010204" HEX#,
S" 8000005400540000000000000000000000000000000000000000000000000000" HEX#,
S" 000000000000000000000000000000000B150200020101010004000404048241" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000508050915000000008050824102000204040408512010101020440301" HEX#,
S" 8040004020103050000000000000000000000000000000000000000000000000" HEX#,
S" 24402010000000002014020100000000201502500C0000000000000000000000" HEX#,
S" C854204400442210000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 021100110F150805000000000054085000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0200000000000000000000000000000000000000000000000000000000000000" HEX#,


CREATE FRAME6
S" 0000000000000000000000000000000000000000000000000000000100040010" HEX#,
S" 0000000000002010000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000010010001120410811"  HEX#,
S" 0040000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000050505020100012041800100119855" HEX#,
S" 0000000000400040000000000000000000000000000000000000000000000000" HEX#,
S" 00000000000000000000000000000001000102000200010122150A0008040000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000020408110251001000418051000403118241211180148855" HEX#,
S" 0000000000400040000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000040300000000008A51B25102040004" HEX#,
S" 2040204000400040000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000004000508050911" HEX#,
S" 8040800000000040000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000005000000000000" HEX#,
S" 0050000000000000000000000000000000000000000000000000000000000000" HEX#,


CREATE FRAME7
S" 0000000000000000000000000000000000000000000000000000000100040000" HEX#,
S" 0000004000000010000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000010001100052251" HEX#,
S" 0010204000000000000000000000000000000000000000000000000000000000" HEX#,
S" 000000000000000000000000000000000001010102050101C0442041C8519A51" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 000000000000000000000000000000000000000100010001A005000400040605" HEX#,
S" 8050201000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000005090102158245004400442201" HEX#,
S" 0000804000002050000000000000000000000000000000000000000000000000" HEX#,
S" 000000000000000000000000000000000004101400000000A215331400440000" HEX#,
S" 3850B05000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000101020002058010200000400040" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000050000000000000050000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,


CREATE FRAME8
S" 0000000000000000000000000000000000000000000000000000000100040000" HEX#,
S" 0000001000100010000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000003140800001000410045" HEX#,
S" 0010200000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000150005000100008044004400450241" HEX#,
S" 800182118214A000804000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000001000100018200020406050810" HEX#,
S" 0000000000008050000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000010101020002010814111000002000" HEX#,
S" 0004024122143E51000000008040800000000000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000102040A11204000008045885106441211" HEX#,
S" 8014200000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000000102040C15021100000040800000000905000000000000" HEX#,
S" 0040000000000000000000000000000000000000000000000000000000000000" HEX#,
S" 0000000000000000080500000000000080400000000000000000000000000000" HEX#,
S" 0000000000000000000000000000000000000000000000000000000000000000" HEX#,


CREATE FILMSTRIP
FRAME0 , FRAME1 , FRAME2 , FRAME3 , FRAME4 , 
FRAME5 , FRAME6 , FRAME7 , FRAME8 ,

: []FIGURE ( n -- ) 9 MOD  CELLS FILMSTRIP + @ PATTERN! ;

VARIABLE SPEED

: STEP   ( n -- )
    DUP []FIGURE   \ load the figure for frame n
    DUP .FIGURE    \ show the figure
    SPEED @ TICKS  \ wait in 16ms increments 
    /FIGURE ;      \ erase figure from display

: STEPS ( n -- )
    PAGE
    0 DO
       I STEP
       ?TERMINAL IF  LEAVE THEN
    LOOP
    CHARSET ;

2000 SPEED !

: RUN   400 STEPS ;
